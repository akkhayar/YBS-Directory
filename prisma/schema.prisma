// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model BusLine {
  id        Int    @id @default(autoincrement())
  busLineId String @unique

  startPointId Int
  endPointId   Int

  startPoint    BusStop         @relation("StartPoint", fields: [startPointId], references: [id])
  endPoint      BusStop         @relation("EndPoint", fields: [endPointId], references: [id])
  RoutedBusStop RoutedBusStop[]
  BusLineMerit  BusLineMerit[]

  @@unique([startPointId, endPointId])
}

model BusLineMerit {
  id        Int     @id @default(autoincrement())
  busLineId String
  merit     String
  amount    Int
  busLine   BusLine @relation(fields: [busLineId], references: [busLineId])

  @@unique([busLineId, merit])
}

model BusStop {
  id            Int             @id @default(autoincrement())
  stopName      String          @unique
  address       String
  longitude     Float
  latitude      Float
  RoutesStart   BusLine[]       @relation("StartPoint")
  RoutesEnd     BusLine[]       @relation("EndPoint")
  RoutedBusStop RoutedBusStop[]
}

model RoutedBusStop {
  id        Int     @id @default(autoincrement())
  stopId    Int
  busLineId String
  stopOrder Int
  stop      BusStop @relation(fields: [stopId], references: [id])
  busLine   BusLine @relation(fields: [busLineId], references: [busLineId])

  @@unique([stopId, busLineId, stopOrder])
}
